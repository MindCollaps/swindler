datasource db {
  provider = "postgres"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                  Int           @id @default(autoincrement())
  username            String
  password            String
  email               String
  emailVerified       Boolean       @default(false)
  disabled            Boolean       @default(false)
  xp                  Int?          @default(0)
  level               Int?          @default(0)
  gamesPlayed         Int?          @default(0)
  userFriends         UserFriends[] @relation("UserAsUser")
  friendOf            UserFriends[] @relation("UserAsFriend")
  admin               Boolean       @default(false)
  playedWords         Word[]
  staredWordLists     StarredList[]
  shareWordListsOwned SharedLists[]
  flaggedWords        FlaggedWord[]
  ownedWordLists      WordList[]
}

model StarredList {
  wordlistId Int
  userId     Int
  wordList   WordList @relation(fields: [wordlistId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([wordlistId, userId])
}

model SharedLists {
  wordlistId Int
  userId     Int
  wordList   WordList @relation(fields: [wordlistId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([wordlistId, userId])
}

model UserFriends {
  userId    Int
  friendId  Int
  createdAt DateTime @default(now())
  status    String   @default("pending") // "pending", "accepted"

  user   User @relation("UserAsUser", fields: [userId], references: [id], onDelete: Cascade)
  friend User @relation("UserAsFriend", fields: [friendId], references: [id], onDelete: Cascade)

  @@id([userId, friendId])
}

model Word {
  id         Int           @id @default(autoincrement())
  word       String
  isCustom   Boolean?      @default(false)
  fromUserId Int?
  from       User?         @relation(fields: [fromUserId], references: [id])
  WordLists  WordList[]
  flagged    FlaggedWord[]
}

model FlaggedWord {
  id             Int     @id @default(autoincrement())
  reporter       Int
  wordId         Int
  word           Word    @relation(fields: [wordId], references: [id])
  reason         Int
  message        String?
  reporterUserId Int?
  reporterUser   User?   @relation(fields: [reporterUserId], references: [id], onDelete: Cascade)
}

model WordList {
  id          Int           @id @default(autoincrement())
  name        String
  description String
  words       Word[]
  shared      Boolean
  public      Boolean
  system      Boolean
  stars       StarredList[]
  sharedLists SharedLists[]
  fromUserId  Int?
  from        User?         @relation(fields: [fromUserId], references: [id])
}
